{"version":3,"sources":["../../src/controllers/auth.controller.ts"],"sourcesContent":["import { NextFunction, Request, Response } from 'express';\r\nimport { RequestWithUser } from '@interfaces/auth.interface';\r\nimport { User } from '@interfaces/users.interface';\r\nimport AuthService from '@services/auth.service';\r\n\r\nclass AuthController {\r\n  public authService = new AuthService();\r\n\r\n  public signUp = async (req: Request, res: Response, next: NextFunction): Promise<void> => {\r\n    try {\r\n      const userData = req.body;\r\n      const signUpUserData = await this.authService.signup(userData);\r\n\r\n      signUpUserData.message ? res.status(400).json(signUpUserData) : res.status(201).json(signUpUserData);\r\n    } catch (error) {\r\n      console.log(error);\r\n    }\r\n  };\r\n\r\n  public logIn = async (req: Request, res: Response, next: NextFunction): Promise<void> => {\r\n    try {\r\n      const userData = req.body;\r\n      const loggedInData = await this.authService.login(userData);\r\n      loggedInData.message ? res.status(403).json(loggedInData) : res.status(200).json(loggedInData);\r\n    } catch (error) {\r\n      console.log(error);\r\n    }\r\n  };\r\n\r\n  public changePassword = async (req: Request, res: Response, next: NextFunction): Promise<void> => {\r\n    try {\r\n      const userData = req.body;\r\n      const email: string = String(req.params.email);\r\n      const chengedData = await this.authService.changePassword(email, userData);\r\n      console.log(chengedData.message);\r\n      \r\n      res.status(200).json(chengedData);\r\n    } catch (error) {\r\n      console.log(error);\r\n    }\r\n  };\r\n\r\n  public generateRefreshToken = async (req: Request, res: Response, next: NextFunction): Promise<void> => {\r\n    try {\r\n      const id = req.body.id;\r\n      const loggedInData = await this.authService.refreshToken(id);\r\n      res.status(200).json(loggedInData);\r\n    } catch (error) {\r\n      next(error);\r\n    }\r\n  };\r\n\r\n  public logOut = async (req: RequestWithUser, res: Response, next: NextFunction): Promise<void> => {\r\n    try {\r\n      const userData: User = req.user;\r\n      const logOutUserData: User = await this.authService.logout(userData);\r\n\r\n      res.setHeader('Set-Cookie', ['Authorization=; Max-age=0']);\r\n      res.status(200).json({ data: logOutUserData, message: 'logout' });\r\n    } catch (error) {\r\n      next(error);\r\n    }\r\n  };\r\n}\r\n\r\nexport default AuthController;\r\n"],"names":["AuthController","authService","AuthService","signUp","req","res","next","userData","body","signUpUserData","signup","message","status","json","error","console","log","logIn","loggedInData","login","changePassword","email","String","params","chengedData","generateRefreshToken","id","refreshToken","logOut","user","logOutUserData","logout","setHeader","data"],"mappings":";;;;+BAiEA;;;eAAA;;;oEA9DwB;;;;;;;;;;;;;;;;;;;AAExB,IAAA,AAAMA,iBAAN,MAAMA;;QACJ,uBAAOC,eAAc,IAAIC,oBAAW;QAEpC,uBAAOC,UAAS,OAAOC,KAAcC,KAAeC;YAClD,IAAI;gBACF,MAAMC,WAAWH,IAAII,IAAI;gBACzB,MAAMC,iBAAiB,MAAM,IAAI,CAACR,WAAW,CAACS,MAAM,CAACH;gBAErDE,eAAeE,OAAO,GAAGN,IAAIO,MAAM,CAAC,KAAKC,IAAI,CAACJ,kBAAkBJ,IAAIO,MAAM,CAAC,KAAKC,IAAI,CAACJ;YACvF,EAAE,OAAOK,OAAO;gBACdC,QAAQC,GAAG,CAACF;YACd;QACF;QAEA,uBAAOG,SAAQ,OAAOb,KAAcC,KAAeC;YACjD,IAAI;gBACF,MAAMC,WAAWH,IAAII,IAAI;gBACzB,MAAMU,eAAe,MAAM,IAAI,CAACjB,WAAW,CAACkB,KAAK,CAACZ;gBAClDW,aAAaP,OAAO,GAAGN,IAAIO,MAAM,CAAC,KAAKC,IAAI,CAACK,gBAAgBb,IAAIO,MAAM,CAAC,KAAKC,IAAI,CAACK;YACnF,EAAE,OAAOJ,OAAO;gBACdC,QAAQC,GAAG,CAACF;YACd;QACF;QAEA,uBAAOM,kBAAiB,OAAOhB,KAAcC,KAAeC;YAC1D,IAAI;gBACF,MAAMC,WAAWH,IAAII,IAAI;gBACzB,MAAMa,QAAgBC,OAAOlB,IAAImB,MAAM,CAACF,KAAK;gBAC7C,MAAMG,cAAc,MAAM,IAAI,CAACvB,WAAW,CAACmB,cAAc,CAACC,OAAOd;gBACjEQ,QAAQC,GAAG,CAACQ,YAAYb,OAAO;gBAE/BN,IAAIO,MAAM,CAAC,KAAKC,IAAI,CAACW;YACvB,EAAE,OAAOV,OAAO;gBACdC,QAAQC,GAAG,CAACF;YACd;QACF;QAEA,uBAAOW,wBAAuB,OAAOrB,KAAcC,KAAeC;YAChE,IAAI;gBACF,MAAMoB,KAAKtB,IAAII,IAAI,CAACkB,EAAE;gBACtB,MAAMR,eAAe,MAAM,IAAI,CAACjB,WAAW,CAAC0B,YAAY,CAACD;gBACzDrB,IAAIO,MAAM,CAAC,KAAKC,IAAI,CAACK;YACvB,EAAE,OAAOJ,OAAO;gBACdR,KAAKQ;YACP;QACF;QAEA,uBAAOc,UAAS,OAAOxB,KAAsBC,KAAeC;YAC1D,IAAI;gBACF,MAAMC,WAAiBH,IAAIyB,IAAI;gBAC/B,MAAMC,iBAAuB,MAAM,IAAI,CAAC7B,WAAW,CAAC8B,MAAM,CAACxB;gBAE3DF,IAAI2B,SAAS,CAAC,cAAc;oBAAC;iBAA4B;gBACzD3B,IAAIO,MAAM,CAAC,KAAKC,IAAI,CAAC;oBAAEoB,MAAMH;oBAAgBnB,SAAS;gBAAS;YACjE,EAAE,OAAOG,OAAO;gBACdR,KAAKQ;YACP;QACF;;AACF;MAEA,WAAed"}