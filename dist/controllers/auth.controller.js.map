{"version":3,"sources":["../../src/controllers/auth.controller.ts"],"sourcesContent":["import { NextFunction, Request, Response } from 'express';\nimport { RequestWithUser } from '@interfaces/auth.interface';\nimport { User } from '@interfaces/users.interface';\nimport AuthService from '@services/auth.service';\n\nclass AuthController {\n  public authService = new AuthService();\n\n  public signUp = async (req: Request, res: Response, next: NextFunction): Promise<void> => {\n    try {\n      const userData = req.body.data;\n      const signUpUserData = await this.authService.signup(userData);\n\n      signUpUserData.message ? res.status(400).json(signUpUserData) : res.status(201).json(signUpUserData);\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  public logIn = async (req: Request, res: Response, next: NextFunction): Promise<void> => {\n    try {\n      const userData = req.body;\n      const loggedInData = await this.authService.login(userData);\n      loggedInData.message ? res.status(403).json(loggedInData) : res.status(200).json(loggedInData);\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  public resendVerificationEMail = async (req: Request, res: Response, next: NextFunction): Promise<void> => {\n    try {\n      const email = String(req.params.email);\n      await this.authService.resendVerificationEmail(email);\n      res.status(200);\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  public changePassword = async (req: Request, res: Response, next: NextFunction): Promise<void> => {\n    try {\n      const userData = req.body;\n      const email: string = String(req.params.email);\n      const chengedData = await this.authService.changePassword(email, userData);\n      console.log(chengedData.message);\n      \n      res.status(200).json(chengedData);\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  public generateRefreshToken = async (req: Request, res: Response, next: NextFunction): Promise<void> => {\n    try {\n      const id = req.body.id;\n      const loggedInData = await this.authService.refreshToken(id);\n      res.status(200).json(loggedInData);\n    } catch (error) {\n      next(error);\n    }\n  };\n\n  public logOut = async (req: RequestWithUser, res: Response, next: NextFunction): Promise<void> => {\n    try {\n      const userData: User = req.user;\n      const logOutUserData: User = await this.authService.logout(userData);\n\n      res.setHeader('Set-Cookie', ['Authorization=; Max-age=0']);\n      res.status(200).json({ data: logOutUserData, message: 'logout' });\n    } catch (error) {\n      next(error);\n    }\n  };\n}\n\nexport default AuthController;\n"],"names":["AuthController","authService","AuthService","signUp","req","res","next","userData","body","data","signUpUserData","signup","message","status","json","error","console","log","logIn","loggedInData","login","resendVerificationEMail","email","String","params","resendVerificationEmail","changePassword","chengedData","generateRefreshToken","id","refreshToken","logOut","user","logOutUserData","logout","setHeader"],"mappings":";;;;+BA2EA;;;eAAA;;;oEAxEwB;;;;;;;;;;;;;;;;;;;AAExB,IAAA,AAAMA,iBAAN,MAAMA;;QACJ,uBAAOC,eAAc,IAAIC,oBAAW;QAEpC,uBAAOC,UAAS,OAAOC,KAAcC,KAAeC;YAClD,IAAI;gBACF,MAAMC,WAAWH,IAAII,IAAI,CAACC,IAAI;gBAC9B,MAAMC,iBAAiB,MAAM,IAAI,CAACT,WAAW,CAACU,MAAM,CAACJ;gBAErDG,eAAeE,OAAO,GAAGP,IAAIQ,MAAM,CAAC,KAAKC,IAAI,CAACJ,kBAAkBL,IAAIQ,MAAM,CAAC,KAAKC,IAAI,CAACJ;YACvF,EAAE,OAAOK,OAAO;gBACdC,QAAQC,GAAG,CAACF;YACd;QACF;QAEA,uBAAOG,SAAQ,OAAOd,KAAcC,KAAeC;YACjD,IAAI;gBACF,MAAMC,WAAWH,IAAII,IAAI;gBACzB,MAAMW,eAAe,MAAM,IAAI,CAAClB,WAAW,CAACmB,KAAK,CAACb;gBAClDY,aAAaP,OAAO,GAAGP,IAAIQ,MAAM,CAAC,KAAKC,IAAI,CAACK,gBAAgBd,IAAIQ,MAAM,CAAC,KAAKC,IAAI,CAACK;YACnF,EAAE,OAAOJ,OAAO;gBACdC,QAAQC,GAAG,CAACF;YACd;QACF;QAEA,uBAAOM,2BAA0B,OAAOjB,KAAcC,KAAeC;YACnE,IAAI;gBACF,MAAMgB,QAAQC,OAAOnB,IAAIoB,MAAM,CAACF,KAAK;gBACrC,MAAM,IAAI,CAACrB,WAAW,CAACwB,uBAAuB,CAACH;gBAC/CjB,IAAIQ,MAAM,CAAC;YACb,EAAE,OAAOE,OAAO;gBACdC,QAAQC,GAAG,CAACF;YACd;QACF;QAEA,uBAAOW,kBAAiB,OAAOtB,KAAcC,KAAeC;YAC1D,IAAI;gBACF,MAAMC,WAAWH,IAAII,IAAI;gBACzB,MAAMc,QAAgBC,OAAOnB,IAAIoB,MAAM,CAACF,KAAK;gBAC7C,MAAMK,cAAc,MAAM,IAAI,CAAC1B,WAAW,CAACyB,cAAc,CAACJ,OAAOf;gBACjES,QAAQC,GAAG,CAACU,YAAYf,OAAO;gBAE/BP,IAAIQ,MAAM,CAAC,KAAKC,IAAI,CAACa;YACvB,EAAE,OAAOZ,OAAO;gBACdC,QAAQC,GAAG,CAACF;YACd;QACF;QAEA,uBAAOa,wBAAuB,OAAOxB,KAAcC,KAAeC;YAChE,IAAI;gBACF,MAAMuB,KAAKzB,IAAII,IAAI,CAACqB,EAAE;gBACtB,MAAMV,eAAe,MAAM,IAAI,CAAClB,WAAW,CAAC6B,YAAY,CAACD;gBACzDxB,IAAIQ,MAAM,CAAC,KAAKC,IAAI,CAACK;YACvB,EAAE,OAAOJ,OAAO;gBACdT,KAAKS;YACP;QACF;QAEA,uBAAOgB,UAAS,OAAO3B,KAAsBC,KAAeC;YAC1D,IAAI;gBACF,MAAMC,WAAiBH,IAAI4B,IAAI;gBAC/B,MAAMC,iBAAuB,MAAM,IAAI,CAAChC,WAAW,CAACiC,MAAM,CAAC3B;gBAE3DF,IAAI8B,SAAS,CAAC,cAAc;oBAAC;iBAA4B;gBACzD9B,IAAIQ,MAAM,CAAC,KAAKC,IAAI,CAAC;oBAAEL,MAAMwB;oBAAgBrB,SAAS;gBAAS;YACjE,EAAE,OAAOG,OAAO;gBACdT,KAAKS;YACP;QACF;;AACF;MAEA,WAAef"}