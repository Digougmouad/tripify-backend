{"version":3,"sources":["../../src/services/admin.service.ts"],"sourcesContent":["import { initializeDbConnection } from '@/app';\r\nimport { uid } from 'uid';\r\nimport aws from 'aws-sdk';\r\nimport moment from 'moment';\r\nimport Stripe from 'stripe';\r\n\r\nclass adminService {\r\n  private stripe = new Stripe(process.env.STRIPE_TEST_KEY, { apiVersion: '2022-11-15' });\r\n\r\n  public async getUnverifiedSellers() {\r\n    const getSellerIdentityCardSession = initializeDbConnection().session({ database: 'neo4j' });\r\n    try {\r\n      const seller = await getSellerIdentityCardSession.executeRead(tx =>\r\n        tx.run(\r\n          'match (s:seller {verified: false}) return s',\r\n        ),\r\n      );\r\n      return seller.records.map(record => record.get(\"s\").properties);\r\n    } catch (error) {\r\n      console.log(error);\r\n    } finally {\r\n        getSellerIdentityCardSession.close();\r\n    }\r\n  }\r\n\r\n  public async getSellerIdentityCard(userid: string) {\r\n    const getSellerIdentityCardSession = initializeDbConnection().session({ database: 'neo4j' });\r\n    try {\r\n      const seller = await getSellerIdentityCardSession.executeRead(tx =>\r\n        tx.run(\r\n          'match (user {id: $userid})-[:IS_A]-(s:seller) return s',\r\n          {\r\n            userid: userid,\r\n          },\r\n        ),\r\n      );\r\n      return {frontSide: seller.records.map(record => record.get(\"s\").properties.frontIdentityCard)[0], backSide: seller.records.map(record => record.get(\"s\").properties.backtIdentityCard)[0]};\r\n    } catch (error) {\r\n      console.log(error);\r\n    } finally {\r\n        getSellerIdentityCardSession.close();\r\n    }\r\n  }\r\n}\r\n\r\nexport default adminService;\r\n"],"names":["adminService","getUnverifiedSellers","getSellerIdentityCardSession","initializeDbConnection","session","database","seller","executeRead","tx","run","records","map","record","get","properties","error","console","log","close","getSellerIdentityCard","userid","frontSide","frontIdentityCard","backSide","backtIdentityCard","stripe","Stripe","process","env","STRIPE_TEST_KEY","apiVersion"],"mappings":";;;;+BA6CA;;;eAAA;;;qBA7CuC;+DAIpB;;;;;;;;;;;;;;;;;;;AAEnB,IAAA,AAAMA,eAAN,MAAMA;IAGJ,MAAaC,uBAAuB;QAClC,MAAMC,+BAA+BC,IAAAA,2BAAsB,IAAGC,OAAO,CAAC;YAAEC,UAAU;QAAQ;QAC1F,IAAI;YACF,MAAMC,SAAS,MAAMJ,6BAA6BK,WAAW,CAACC,CAAAA,KAC5DA,GAAGC,GAAG,CACJ;YAGJ,OAAOH,OAAOI,OAAO,CAACC,GAAG,CAACC,CAAAA,SAAUA,OAAOC,GAAG,CAAC,KAAKC,UAAU;QAChE,EAAE,OAAOC,OAAO;YACdC,QAAQC,GAAG,CAACF;QACd,SAAU;YACNb,6BAA6BgB,KAAK;QACtC;IACF;IAEA,MAAaC,sBAAsBC,MAAc,EAAE;QACjD,MAAMlB,+BAA+BC,IAAAA,2BAAsB,IAAGC,OAAO,CAAC;YAAEC,UAAU;QAAQ;QAC1F,IAAI;YACF,MAAMC,SAAS,MAAMJ,6BAA6BK,WAAW,CAACC,CAAAA,KAC5DA,GAAGC,GAAG,CACJ,0DACA;oBACEW,QAAQA;gBACV;YAGJ,OAAO;gBAACC,WAAWf,OAAOI,OAAO,CAACC,GAAG,CAACC,CAAAA,SAAUA,OAAOC,GAAG,CAAC,KAAKC,UAAU,CAACQ,iBAAiB,CAAC,CAAC,EAAE;gBAAEC,UAAUjB,OAAOI,OAAO,CAACC,GAAG,CAACC,CAAAA,SAAUA,OAAOC,GAAG,CAAC,KAAKC,UAAU,CAACU,iBAAiB,CAAC,CAAC,EAAE;YAAA;QAC3L,EAAE,OAAOT,OAAO;YACdC,QAAQC,GAAG,CAACF;QACd,SAAU;YACNb,6BAA6BgB,KAAK;QACtC;IACF;;QAnCA,uBAAQO,UAAS,IAAIC,eAAM,CAACC,QAAQC,GAAG,CAACC,eAAe,EAAE;YAAEC,YAAY;QAAa;;AAoCtF;MAEA,WAAe9B"}